<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Treinamento - Barone</title>

  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="icon" href="./assets/icon.svg" type="image/svg+xml" />

  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true">ü•ã</div>
      <div class="brandText">
        <h1>Treinamento - Barone</h1>
        <p class="sub">Alongamento ‚Ä¢ Jud√¥ (circuito) ‚Ä¢ Treino do Alberto ‚Ä¢ YouTube embutido ‚Ä¢ Regressiva 5‚Üí1</p>
      </div>
    </div>

    <div class="right">
      <div class="pill" id="statusPill">Pronto</div>
      <button class="iconBtn" id="installBtn" title="Instalar (se dispon√≠vel)" aria-label="Instalar">‚¨áÔ∏è</button>
    </div>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tab active" data-tab="sessao" role="tab" aria-selected="true">Sess√£o</button>
    <button class="tab" data-tab="banco" role="tab" aria-selected="false">Banco</button>
    <button class="tab" data-tab="historico" role="tab" aria-selected="false">Hist√≥rico & Exportar</button>
  </nav>

  <main class="container">
    <!-- TAB: SESSAO -->
    <section class="tabPanel active" id="tab-sessao" role="tabpanel">
      <div class="grid">
        <section class="card">
          <div class="cardHead">
            <h2>Configura√ß√£o</h2>
            <div class="mini" id="summaryLine">‚Äî</div>
          </div>

          <div class="form">
            <div class="row2">
              <label>
                Programa
                <select id="programType">
                  <option value="stretch" selected>Alongamento (Pr√©/P√≥s)</option>
                  <option value="judo">Jud√¥ (Circuito)</option>
                  <option value="alberto">Treino do Alberto</option>
                </select>
              </label>

              <label>
                Nome da sess√£o (opcional)
                <input id="sessionName" type="text" placeholder="Ex: Pr√©-judo 8min / Circuito A / Treino B" />
              </label>
            </div>

            <!-- Alongamento -->
            <div id="cfg-stretch">
              <div class="row2">
                <label>
                  Tipo
                  <select id="mode">
                    <option value="pre" selected>Pr√©-treino (din√¢mico)</option>
                    <option value="post">P√≥s-treino (est√°tico)</option>
                  </select>
                </label>

                <label>
                  Tempo total (min)
                  <input id="totalMinutes" type="number" min="1" max="180" step="1" value="8" />
                </label>
              </div>

              <div class="row2">
                <label>
                  Tempo por alongamento (s)
                  <select id="stretchSeconds">
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30" selected>30</option>
                    <option value="40">40</option>
                    <option value="45">45</option>
                    <option value="60">60</option>
                  </select>
                </label>

                <label>
                  Intervalo entre alongamentos (s)
                  <select id="restSeconds">
                    <option value="0">0</option>
                    <option value="5" selected>5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                  </select>
                </label>
              </div>

              <div class="row2">
                <label>
                  Lado inicial (se o alongamento for ‚Äúum lado‚Äù)
                  <select id="startSide">
                    <option value="L" selected>Esquerda</option>
                    <option value="R">Direita</option>
                  </select>
                </label>

                <label>
                  Modo de lado (para itens com <code>sides: "LR"</code>)
                  <select id="unilateralMode">
                    <option value="off" selected>Ignorar (n√£o usar lados)</option>
                    <option value="alternate">Alternar lados (E/D)</option>
                    <option value="pairs">Em pares (mesmo alongamento: E depois D)</option>
                  </select>
                </label>
              </div>

              <div class="row wrap">
                <div class="kpi">Estimativa: <b id="estimatedCount">‚Äî</b> alongamentos</div>
                <div class="hint">Para usar altern√¢ncia E/D, marque alguns itens no Banco com <code>sides: "LR"</code> (ou use seus personalizados).</div>
              </div>
            </div>

            <!-- Jud√¥ -->
            <div id="cfg-judo" class="hidden">
              <div class="row2">
                <label>
                  Trabalho por esta√ß√£o (s)
                  <input id="judoWorkSec" type="number" min="5" max="600" step="1" value="40" />
                </label>
                <label>
                  Descanso entre esta√ß√µes (s)
                  <input id="judoRestSec" type="number" min="0" max="600" step="1" value="20" />
                </label>
              </div>
              <div class="row2">
                <label>
                  Rounds
                  <input id="judoRounds" type="number" min="1" max="20" step="1" value="3" />
                </label>
                <label>
                  Descanso entre rounds (s)
                  <input id="judoRestRoundsSec" type="number" min="0" max="600" step="1" value="60" />
                </label>
              </div>

              <div class="toggles">
                <label class="toggle">
                  <input id="judoShuffle" type="checkbox" />
                  <span>Embaralhar esta√ß√µes a cada gera√ß√£o</span>
                </label>
              </div>

              <h3>Esta√ß√µes (checklist manual)</h3>
              <div class="row2">
                <label>
                  Adicionar esta√ß√£o r√°pida
                  <input id="judoQuickName" type="text" placeholder="Ex: Uchi-komi, burpee, pegada..." />
                </label>
                <button id="judoQuickAddBtn" class="btn" type="button">Adicionar</button>
              </div>

              <div class="row wrap">
                <button id="judoSelectAllBtn" class="btn" type="button">Selecionar todas</button>
                <button id="judoSelectNoneBtn" class="btn" type="button">Selecionar nenhuma</button>
              </div>

              <div class="exerciseList" id="judoChecklist"></div>
              <div class="hint">Dica: ajuste v√≠deos/nomes no Banco ‚Üí Jud√¥.</div>
            </div>

            <!-- Alberto -->
            <div id="cfg-alberto" class="hidden">
              <div class="row2">
                <label>
                  Ciclo
                  <input id="albCycle" type="text" value="Ciclo II" />
                </label>
                <label>
                  Fase
                  <input id="albPhase" type="text" value="Fase 3" />
                </label>
              </div>
              <div class="row2">
                <label>
                  Semana
                  <input id="albWeek" type="number" min="1" max="99" step="1" value="11" />
                </label>
                <label>
                  Treino
                  <select id="albSessionSelect"></select>
                </label>
              </div>

              <div class="row wrap">
                <label class="btn fileBtn">
                  Importar pacote/treino (.json)
                  <input id="albImportFile" type="file" accept="application/json" />
                </label>
                <button id="albResetPackBtn" class="btn danger" type="button">Limpar treinos importados</button>
              </div>
              <div class="row wrap">
                <div class="kpi">Semana atual: <b id="albWeekPill">‚Äî</b></div>
              </div>
              <div class="hint">Importe novos ciclos/fases em JSON. O app mant√©m hist√≥rico e cargas (linha do tempo).</div>
            </div>

            <!-- Comum -->
            <div class="toggles">
              <label class="toggle">
                <input id="beepEnabled" type="checkbox" checked />
                <span>Beep nos √∫ltimos 5 segundos</span>
              </label>
              <label class="toggle">
                <input id="speakEndEnabled" type="checkbox" checked />
                <span>Falar ‚Äúconclu√≠do‚Äù no final</span>
              </label>
              <label class="toggle">
                <input id="speakCountdownEnabled" type="checkbox" />
                <span>Falar 5‚Äì1 (opcional)</span>
              </label>
              <label class="toggle">
                <input id="announceStepEnabled" type="checkbox" checked />
                <span>Falar o nome ao come√ßar</span>
              </label>
            </div>

            <div class="row2">
              <label>
                Prefer√™ncia de voz
                <select id="voicePref">
                  <option value="auto" selected>Autom√°tica</option>
                  <option value="female">Preferir feminina</option>
                  <option value="male">Preferir masculina</option>
                  <option value="off">Sem voz</option>
                </select>
              </label>

              <label>
                Voz espec√≠fica (opcional)
                <select id="voiceSelect"></select>
              </label>
            </div>

            <div class="row">
              <button id="generateBtn" class="btn primary">Gerar sess√£o</button>
              <button id="startBtn" class="btn primary" disabled>Iniciar</button>
              <button id="saveSessionBtn" class="btn" disabled>Salvar sess√£o</button>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="cardHead">
            <h2>Execu√ß√£o</h2>
            <div class="mini" id="stepCounter">‚Äî</div>
          </div>

          <div class="player">
            <div class="sessionTop">
              <div>
                <div class="chip" id="chipPhase">‚Äî</div>
                <div class="nowTitle" id="nowTitle">‚Äî</div>
                <div class="nowSub" id="nowSub">‚Äî</div>
              </div>

              <div class="timer">
                <div class="timerBig" id="timerBig">00:00</div>
                <div class="timerSub" id="timerSub">restante</div>
              </div>
            </div>

            <div class="videoWrap">
              <div id="videoFallback" class="videoFallback hidden">
                <div class="videoFallbackTitle">Sem v√≠deo configurado</div>
                <div class="mini">Use o bot√£o abaixo para pesquisar no YouTube.</div>
                <button id="btnOpenSearch" class="btn" type="button">Procurar no YouTube</button>
              </div>

              <iframe
                id="youtubeFrame"
                class="youtube"
                title="V√≠deo"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen
                referrerpolicy="strict-origin-when-cross-origin"
              ></iframe>
            </div>

            <div class="progress">
              <div class="progressTop">
                <div><span id="progressIndex">0</span>/<span id="progressTotal">0</span></div>
                <div class="mini">Pr√≥ximo: <span id="nextName">‚Äî</span></div>
              </div>
              <div class="bar"><div id="barFill" class="barFill"></div></div>
            </div>

            <div class="countdownLine">
              <div class="mini" id="countdownLabel"></div>
              <div class="countdown" id="countdownText"></div>
            </div>

            <!-- Registro do Alberto -->
            <div id="albertoLogBox" class="logBox hidden">
              <div class="logHead">
                <h3>Registro (Alberto)</h3>
                <div class="mini" id="albLogMeta">‚Äî</div>
              </div>

              <div class="row2">
                <label>
                  V√≠deo (YouTube link ou ID)
                  <input id="albVideoLink" type="text" placeholder="https://youtu.be/..." />
                </label>
                <label>
                  Carga usada
                  <input id="albLoad" type="text" placeholder="Ex: 15 kg" />
                </label>
              </div>

              <div class="row2">
                <label>
                  Reps/tempo (feito)
                  <input id="albRepsDone" type="text" placeholder="Ex: 5x6 / 12 reps / 20s" />
                </label>
                <label>
                  Notas
                  <input id="albNotes" type="text" placeholder="Ex: sem dor, boa execu√ß√£o" />
                </label>
              </div>

              <div class="row wrap">
                <button id="albSaveLogBtn" class="btn primary" type="button">Salvar</button>
                <button id="albClearLogBtn" class="btn" type="button">Limpar</button>
              </div>
              <div class="hint">O app lembra o v√≠deo e as √∫ltimas cargas por exerc√≠cio e cria uma linha do tempo no Hist√≥rico.</div>
            </div>

            <div class="row wrap">
              <button id="pauseBtn" class="btn" disabled>Pausar</button>
              <button id="prevBtn" class="btn" disabled>Anterior</button>
              <button id="nextBtn" class="btn" disabled>Pr√≥ximo</button>
              <button id="stopBtn" class="btn danger" disabled>Encerrar</button>
              <button id="copyBtn" class="btn" disabled>Copiar sess√£o</button>
            </div>

            <div class="small" id="sessionStatus"></div>
          </div>
        </section>

        <section class="card full">
          <div class="cardHead">
            <h2>Sequ√™ncia</h2>
            <div class="mini" id="sequenceMeta">‚Äî</div>
          </div>
          <ol id="sequenceList" class="routine"></ol>
        </section>
      </div>
    </section>

    <!-- TAB: BANCO -->
    <section class="tabPanel" id="tab-banco" role="tabpanel">
      <div class="grid">
        <section class="card full">
          <div class="cardHead">
            <h2>Banco</h2>
            <div class="mini" id="bankMeta">‚Äî</div>
          </div>

          <div class="row2">
            <label>
              Tipo de banco
              <select id="bankType">
                <option value="stretch" selected>Alongamentos</option>
                <option value="judo">Jud√¥ (esta√ß√µes)</option>
                <option value="alberto">Exerc√≠cios (Alberto)</option>
              </select>
            </label>
            <label>
              Buscar
              <input id="bankSearch" type="text" placeholder="Ex: quadr√≠ceps, uchi-komi, supino..." />
            </label>
          </div>

          <!-- Banco: Alongamentos -->
          <div id="bank-stretch">
            <div class="row2">
              <label>
                Filtro (pr√©/p√≥s)
                <select id="bankPhaseFilter">
                  <option value="all" selected>Todos</option>
                  <option value="pre">Pr√©-treino</option>
                  <option value="post">P√≥s-treino</option>
                  <option value="custom">Personalizados</option>
                </select>
              </label>
              <label>
                Regi√£o
                <select id="bankRegionFilter">
                  <option value="all" selected>Todas</option>
                </select>
              </label>
            </div>

            <div class="row2">
              <label>
                N√≠vel
                <select id="bankLevelFilter">
                  <option value="all" selected>Todos</option>
                  <option value="beginner">Beginner</option>
                  <option value="intermediate">Intermediate</option>
                  <option value="advanced">Advanced</option>
                </select>
              </label>
              <div></div>
            </div>

            <div class="row wrap">
              <button id="selectAllBtn" class="btn" type="button">Selecionar tudo</button>
              <button id="selectNoneBtn" class="btn" type="button">Selecionar nada</button>
              <button id="deleteCustomBtn" class="btn danger" type="button">Apagar selecionados (personalizados)</button>
            </div>

            <div class="exerciseList" id="bankList"></div>

            <hr class="sep" />

            <h3>Novo alongamento (personalizado)</h3>
            <div class="row2">
              <label>
                Nome (PT)
                <input id="newNamePt" type="text" placeholder="Ex: Alongamento de panturrilha na parede" />
              </label>
              <label>
                Tipo (pr√©/p√≥s)
                <select id="newPhase">
                  <option value="pre">Pr√©-treino</option>
                  <option value="post" selected>P√≥s-treino</option>
                </select>
              </label>
            </div>

            <div class="row2">
              <label>
                Regi√£o (texto curto)
                <input id="newRegion" type="text" placeholder="Ex: calf, hamstring, hip..." />
              </label>
              <label>
                Lados (opcional)
                <select id="newSides">
                  <option value="N" selected>Sem lado</option>
                  <option value="LR">Um lado (E/D)</option>
                  <option value="B">Bilateral</option>
                </select>
              </label>
            </div>

            <div class="row2">
              <label>
                YouTube ID (opcional)
                <input id="newYoutubeId" type="text" placeholder="Ex: dQw4w9WgXcQ" />
              </label>
              <label>
                Busca YouTube (opcional)
                <input id="newSearchQuery" type="text" placeholder="Ex: calf stretch wall" />
              </label>
            </div>

            <div class="row">
              <button id="addCustomBtn" class="btn primary" type="button">Adicionar</button>
              <button id="resetCustomBtn" class="btn" type="button">Apagar todos personalizados</button>
            </div>

            <div class="hint">
              Personalizados ficam salvos no aparelho. Para marcar ‚Äúum lado‚Äù, use <code>Lados: Um lado (E/D)</code>.
            </div>
          </div>

          <!-- Banco: Jud√¥ -->
          <div id="bank-judo" class="hidden">
            <div class="row wrap">
              <label class="mini">Edite o nome e cole o v√≠deo do YouTube (opcional). Essas esta√ß√µes aparecem como checklist no Circuito.</label>
            </div>

            <div class="row2">
              <label>
                Nova esta√ß√£o
                <input id="judoNewStation" type="text" placeholder="Ex: Uchi-komi, pegada, corrida..." />
              </label>
              <button id="judoAddStationBtn" class="btn primary" type="button">Adicionar</button>
            </div>

            <div class="exerciseList" id="judoBankList"></div>
          </div>

          <!-- Banco: Alberto -->
          <div id="bank-alberto" class="hidden">
            <div class="row wrap">
              <label class="mini">Cole o link/ID do YouTube para cada exerc√≠cio. O app vai embutir o v√≠deo quando o exerc√≠cio aparecer.</label>
            </div>

            <div class="exerciseList" id="albertoBankList"></div>
          </div>

        </section>
      </div>
    </section>

    <!-- TAB: HISTORICO -->
    <section class="tabPanel" id="tab-historico" role="tabpanel">
      <div class="grid">
        <section class="card full">
          <div class="cardHead">
            <h2>Hist√≥rico & Dados</h2>
            <div class="mini" id="historyMeta">‚Äî</div>
          </div>

          <div class="row wrap">
            <button id="exportBtn" class="btn" type="button">Exportar dados (.json)</button>
            <label class="btn fileBtn">
              Importar .json
              <input id="importFile" type="file" accept="application/json" />
            </label>
            <button id="clearHistoryBtn" class="btn danger" type="button">Limpar hist√≥rico</button>
          </div>

          <div class="historyList" id="historyList"></div>

          <hr class="sep" />

          <h3>Sess√£o salva</h3>
          <div class="row wrap">
            <button id="loadSavedBtn" class="btn" type="button">Carregar sess√£o salva</button>
            <button id="deleteSavedBtn" class="btn danger" type="button">Apagar sess√£o salva</button>
          </div>
          <div class="hint" id="savedHint">‚Äî</div>
        </section>
      </div>
    </section>
  </main>

  <footer class="footer">
    <span>v6.2 ‚Ä¢ GitHub Pages ‚Ä¢ HTML/CSS/JS</span>
  </footer>

  <script src="./app.js"></script>
</body>
</html>
